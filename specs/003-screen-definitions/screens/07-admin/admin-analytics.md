# Screen: Admin Analytics (분석)

**Route**: `/admin/analytics`
**Status**: Implemented
**Last Updated**: 2025-12-18
**Priority**: P2
**Dependencies**: Admin Auth, Analytics System

---

## 1. 화면 개요

### 목적
플랫폼 사용 현황, 리드 통계, 매출 데이터를 시각화하여 비즈니스 인사이트를 제공한다.

### 사용자 흐름
```
/admin → /admin/analytics → 기간 선택 → 차트/데이터 확인
```

### 접근 조건
- **인증 필요**: Yes
- **권한 수준**: admin
- **전제 조건**: 관리자 로그인 완료

---

## 2. 레이아웃 구조

```
┌────────────────────────────────────────────────────────────────────────────┐
│ Admin Header                              [관리자: admin@teeup.kr] [로그아웃]│
├────────────────────────────────────────────────────────────────────────────┤
│ [대시보드] [프로 관리] [사용자 관리] [채팅 관리] [분석]     ← Admin Nav      │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│  분석                                    기간: [지난 7일 ▼] ~ [오늘]         │
│                                                                            │
│  ┌─────────────────┐ ┌─────────────────┐ ┌─────────────────┐ ┌───────────┐│
│  │ 총 리드         │ │ 전환율          │ │ 활성 프로        │ │ 신규 가입  ││
│  │     156        │ │    12.3%       │ │      45        │ │    89     ││
│  │ +23% ↑        │ │ +2.1pp ↑       │ │ +3 이번 주      │ │ 이번 주    ││
│  └─────────────────┘ └─────────────────┘ └─────────────────┘ └───────────┘│
│                                                                            │
│  리드 추이                                                                  │
│  ┌──────────────────────────────────────────────────────────────────────┐ │
│  │                                                                      │ │
│  │   📈 [라인 차트: 일별 리드 수]                                         │ │
│  │                                                                      │ │
│  │  30 ─                              *                                 │ │
│  │  20 ─           *        *    *         *                           │ │
│  │  10 ─    *  *                               *                        │ │
│  │   0 ─────────────────────────────────────────                        │ │
│  │       1/9 1/10 1/11 1/12 1/13 1/14 1/15                              │ │
│  │                                                                      │ │
│  └──────────────────────────────────────────────────────────────────────┘ │
│                                                                            │
│  ┌─────────────────────────────────┐ ┌─────────────────────────────────┐  │
│  │ 리드 소스                        │ │ 상위 프로                        │  │
│  │ ┌─────────────────────────────┐│ │ ┌─────────────────────────────┐ │  │
│  │ │  [파이 차트]                 ││ │ │ 1. 김프로      45건          │ │  │
│  │ │                             ││ │ │ 2. 이프로      32건          │ │  │
│  │ │  • 포트폴리오 직접: 60%     ││ │ │ 3. 박프로      28건          │ │  │
│  │ │  • 검색/디렉토리: 25%       ││ │ │ 4. 최프로      21건          │ │  │
│  │ │  • 외부 링크: 15%           ││ │ │ 5. 정프로      15건          │ │  │
│  │ └─────────────────────────────┘│ │ └─────────────────────────────┘ │  │
│  └─────────────────────────────────┘ └─────────────────────────────────┘  │
│                                                                            │
│  [CSV 내보내기]                                                             │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
```

---

## 3. 주요 컴포넌트

### 3.1 DateRangePicker

**기간 선택**

| Preset | Range |
|--------|-------|
| 오늘 | 당일 |
| 지난 7일 | 최근 7일 |
| 지난 30일 | 최근 30일 |
| 이번 달 | 해당 월 |
| 커스텀 | 날짜 직접 선택 |

### 3.2 MetricCard

**지표 카드**

| Metric | Description | Calculation |
|--------|-------------|-------------|
| 총 리드 | 기간 내 리드 수 | SUM(leads) |
| 전환율 | 리드 → 레슨 전환 | converted / total * 100 |
| 활성 프로 | 기간 내 활동한 프로 | DISTINCT pros with leads |
| 신규 가입 | 기간 내 신규 가입 | SUM(new_users) |

### 3.3 LeadTrendChart

**리드 추이 차트**

| Property | Value |
|----------|-------|
| 차트 유형 | 라인 차트 |
| X축 | 날짜 |
| Y축 | 리드 수 |
| 데이터 포인트 | 일별 집계 |

### 3.4 LeadSourceChart

**리드 소스 차트**

| Property | Value |
|----------|-------|
| 차트 유형 | 파이/도넛 차트 |
| 카테고리 | 포트폴리오 직접, 검색/디렉토리, 외부 링크 |

### 3.5 TopProsTable

**상위 프로 테이블**

| Column | Description |
|--------|-------------|
| 순위 | 1~10위 |
| 프로 이름 | 프로 이름 (링크) |
| 리드 수 | 기간 내 획득 리드 수 |

### 3.6 ExportButton

**내보내기 버튼**

| Format | Description |
|--------|-------------|
| CSV | 원본 데이터 다운로드 |

---

## 4. 데이터 요구사항

### Server Actions

| Action | 설명 |
|--------|------|
| `getAnalyticsOverview` | 주요 지표 요약 |
| `getLeadTrend` | 일별 리드 추이 |
| `getLeadSources` | 리드 소스 분포 |
| `getTopPros` | 상위 프로 목록 |
| `exportAnalyticsCSV` | CSV 내보내기 |

### 데이터 스키마

```typescript
interface AnalyticsOverview {
  totalLeads: number;
  totalLeadsChange: number;
  conversionRate: number;
  conversionRateChange: number;
  activePros: number;
  newActivePros: number;
  newSignups: number;
}

interface LeadTrendPoint {
  date: string;
  count: number;
}

interface LeadSource {
  source: 'portfolio' | 'search' | 'external';
  count: number;
  percentage: number;
}

interface TopPro {
  id: string;
  name: string;
  slug: string;
  leadCount: number;
}
```

---

## 5. 인터랙션 정의

### 5.1 기간 변경

1. **Given** 분석 페이지가 표시될 때
2. **When** 기간을 변경하면
3. **Then** 모든 차트와 지표가 새 기간으로 갱신됨

### 5.2 차트 호버

1. **Given** 차트가 표시될 때
2. **When** 데이터 포인트에 마우스를 올리면
3. **Then** 툴팁으로 상세 값 표시

### 5.3 CSV 내보내기

1. **Given** 분석 페이지가 표시될 때
2. **When** "CSV 내보내기" 버튼을 클릭하면
3. **Then** 현재 기간의 데이터가 CSV로 다운로드됨

---

## 6. 접근성 요구사항

- [ ] 차트: 대체 텍스트 또는 데이터 테이블 제공
- [ ] 지표 카드: 증감 정보 스크린 리더 지원
- [ ] 기간 선택: 키보드 접근 가능
- [ ] 색상: 색맹 고려한 차트 팔레트

---

## 7. 에러 케이스

| 에러 유형 | 처리 |
|----------|------|
| 데이터 없음 | "선택한 기간에 데이터가 없습니다" |
| 로드 실패 | Skeleton UI + 재시도 버튼 |
| 내보내기 실패 | Toast 에러 메시지 |

---

## 8. 관련 화면

- **이전 화면**: [Admin Dashboard](./admin-dashboard.md)
- **연관 화면**: [Admin Pros](./admin-pros.md)
